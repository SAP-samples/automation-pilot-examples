{
  "id": "examples-<<<TENANT_ID>>>",
  "technicalName": "examples",
  "name": "Automation Pilot Examples",
  "description": "Source: https://github.com/SAP-samples/automation-pilot-examples",
  "owner": "<<<TENANT_ID>>>",
  "inputs": [
    {
      "id": "examples-<<<TENANT_ID>>>:CloudAlmCredentials:1",
      "name": "CloudAlmCredentials",
      "description": "Cloud ALM service key container. Used for authenticated metric publishing to Health Monitoring.",
      "catalog": "examples-<<<TENANT_ID>>>",
      "owner": null,
      "version": 1,
      "keys": {
        "serviceKey": {
          "type": "object",
          "sensitive": true,
          "description": "Full Cloud ALM service key JSON object (OAuth + endpoints)"
        }
      },
      "values": {
        "serviceKey": ""
      },
      "tags": {}
    }
  ],
  "commands": [
    {
      "configuration": {
        "values": [],
        "output": {
          "status": "$(.Probe.output.status)"
        },
        "executors": [
          {
            "execute": "http-sapcp:HttpRequest:1",
            "input": {
              "method": "GET",
              "sccLocationId": "$(.execution.input.sccLocationId)",
              "successResponseCodes": "[\"2xx\",\"3xx\",\"4xx\",\"5xx\",\"-1\"]",
              "url": "https://$(.execution.input.virtualHost):$(.execution.input.virtualPort)$(.execution.input.path)",
              "timeout": "$(.execution.input.timeout)",
              "sccEnabled": "true"
            },
            "alias": "Probe",
            "description": null,
            "progressMessage": null,
            "initialDelay": null,
            "pause": null,
            "when": null,
            "validate": null,
            "autoRetry": null,
            "repeat": null,
            "errorMessages": [],
            "dryRun": null
          },
          {
            "execute": "calmhm-sapcp:PushCloudAlmStatusMetric:1",
            "input": {
              "severity": "$(if .Probe.output.status == .execution.input.expectedStatus then \"ok\" else \"critical\" end)",
              "metricName": "$(.execution.input.metricName)",
              "attributes": "$({ path: .execution.input.path, host: .execution.input.virtualHost })",
              "serviceKey": "$(.execution.input.serviceKey)",
              "message": "$(if .Probe.output.status == .execution.input.expectedStatus then \"Endpoint reachable via SCC\" else \"Error: \\(.Probe.output.body)\" end)",
              "serviceId": "$(.execution.input.serviceId)"
            },
            "alias": "PushStatus",
            "description": null,
            "progressMessage": null,
            "initialDelay": null,
            "pause": null,
            "when": null,
            "validate": null,
            "autoRetry": null,
            "repeat": null,
            "errorMessages": [],
            "dryRun": null
          }
        ],
        "listeners": []
      },
      "id": "examples-<<<TENANT_ID>>>:CheckCloudConnectorStatus:1",
      "name": "CheckCloudConnectorStatus",
      "description": "Probes an on-premise HTTP endpoint via SAP Cloud Connector and publishes a status metric (OK or Critical) to Cloud ALM Health Monitoring",
      "catalog": "examples-<<<TENANT_ID>>>",
      "version": 1,
      "inputKeys": {
        "path": {
          "type": "string",
          "sensitive": false,
          "required": false,
          "minSize": null,
          "maxSize": null,
          "minValue": null,
          "maxValue": null,
          "allowedValues": null,
          "allowedValuesFromInputKeys": null,
          "suggestedValues": null,
          "suggestedValuesFromInputKeys": null,
          "defaultValue": "/",
          "defaultValueFromInput": null,
          "description": "Relative endpoint path (must start with /). Use a lightweight health URI (e.g., /health, /sap/public/ping)."
        },
        "metricName": {
          "type": "string",
          "sensitive": false,
          "required": false,
          "minSize": null,
          "maxSize": null,
          "minValue": null,
          "maxValue": null,
          "allowedValues": null,
          "allowedValuesFromInputKeys": null,
          "suggestedValues": null,
          "suggestedValuesFromInputKeys": null,
          "defaultValue": "SCC Connection Status",
          "defaultValueFromInput": null,
          "description": "Display name of the status metric in Cloud ALM (include environment/location if needed)."
        },
        "expectedStatus": {
          "type": "number",
          "sensitive": false,
          "required": false,
          "minSize": null,
          "maxSize": null,
          "minValue": null,
          "maxValue": null,
          "allowedValues": null,
          "allowedValuesFromInputKeys": null,
          "suggestedValues": null,
          "suggestedValuesFromInputKeys": null,
          "defaultValue": "200",
          "defaultValueFromInput": null,
          "description": "HTTP status code considered healthy (default 200)."
        },
        "sccLocationId": {
          "type": "string",
          "sensitive": false,
          "required": false,
          "minSize": null,
          "maxSize": null,
          "minValue": null,
          "maxValue": null,
          "allowedValues": null,
          "allowedValuesFromInputKeys": null,
          "suggestedValues": null,
          "suggestedValuesFromInputKeys": null,
          "defaultValue": null,
          "defaultValueFromInput": null,
          "description": "(Optional) SAP Cloud Connector Location ID. Leave empty if not configured."
        },
        "serviceKey": {
          "type": "object",
          "sensitive": true,
          "required": false,
          "minSize": null,
          "maxSize": null,
          "minValue": null,
          "maxValue": null,
          "allowedValues": null,
          "allowedValuesFromInputKeys": null,
          "suggestedValues": null,
          "suggestedValuesFromInputKeys": null,
          "defaultValue": null,
          "defaultValueFromInput": {
            "inputReference": "examples-<<<TENANT_ID>>>:CloudAlmCredentials:1",
            "inputKey": "serviceKey"
          },
          "description": "Resolved Cloud ALM service key object (injected via CloudAlmCredentials)."
        },
        "virtualHost": {
          "type": "string",
          "sensitive": false,
          "required": true,
          "minSize": null,
          "maxSize": null,
          "minValue": null,
          "maxValue": null,
          "allowedValues": null,
          "allowedValuesFromInputKeys": null,
          "suggestedValues": null,
          "suggestedValuesFromInputKeys": null,
          "defaultValue": null,
          "defaultValueFromInput": null,
          "description": "Virtual host defined in SAP Cloud Connector mapping (hostname only)."
        },
        "serviceId": {
          "type": "string",
          "sensitive": false,
          "required": true,
          "minSize": null,
          "maxSize": null,
          "minValue": null,
          "maxValue": null,
          "allowedValues": null,
          "allowedValuesFromInputKeys": null,
          "suggestedValues": null,
          "suggestedValuesFromInputKeys": null,
          "defaultValue": null,
          "defaultValueFromInput": null,
          "description": "Cloud ALM Landscape Management service ID to associate the metric with."
        },
        "virtualPort": {
          "type": "number",
          "sensitive": false,
          "required": true,
          "minSize": null,
          "maxSize": null,
          "minValue": null,
          "maxValue": null,
          "allowedValues": null,
          "allowedValuesFromInputKeys": null,
          "suggestedValues": null,
          "suggestedValuesFromInputKeys": null,
          "defaultValue": null,
          "defaultValueFromInput": null,
          "description": "Virtual port from SAP Cloud Connector mapping for the system."
        },
        "timeout": {
          "type": "number",
          "sensitive": false,
          "required": false,
          "minSize": null,
          "maxSize": null,
          "minValue": null,
          "maxValue": null,
          "allowedValues": null,
          "allowedValuesFromInputKeys": null,
          "suggestedValues": null,
          "suggestedValuesFromInputKeys": null,
          "defaultValue": "10",
          "defaultValueFromInput": null,
          "description": "Probe timeout in seconds (default 10). Increase for slower endpoints if needed"
        }
      },
      "outputKeys": {
        "status": {
          "type": "number",
          "sensitive": false,
          "description": "Actual HTTP status returned (or -1 for transport failure)."
        }
      },
      "tags": {},
      "issues": []
    }
  ]
}
